function topBannerRotation(){var a=$(".feature__point").index($(".feature__point.active")),b=$(".js-feature-item").length;bannerCurrent.toggleClass("hidden visible"),a+1==b?($(".feature__point").removeClass("active").eq(0).addClass("active"),bannerCurrent=$(".js-feature-item").eq(0)):($(".feature__point.active").removeClass("active").next().addClass("active"),bannerCurrent=bannerCurrent.next()),bannerCurrent.toggleClass("hidden visible")}function topBanner(){var a=$(".js-feature-item"),b=a.length;if(bannerCurrent=a.eq(0),b>1){var c;$(".js-feature-item:gt(0)").addClass("hidden"),bannerCurrent.addClass("visible"),$(".js-feature").before('<div class="feature__points"></div>'),c=$(".feature__points");for(var d=1;d<=b;d++){var e=1==d?" active":"";c.append('<div class="feature__point'+e+'"></div>')}bannerInterval=setInterval(topBannerRotation,9e3)}}function intervalReset(){clearInterval(bannerInterval),bannerInterval=0,clearTimeout(bannerTimeout),bannerTimeout=setTimeout(function(){bannerInterval=setInterval(topBannerRotation,9e3)},7e3)}function streamCreate(){$.ajax({type:"GET",url:"/user/stream",dataType:"JSON",success:function(a){var b=Object.keys(a).slice(0,3);$.each(b,function(){this.toString();$(".js-stream").append('<div class="preview preview--vk">            <div class="preview__title">              <i class="icon icon--video-vk"></i>              <div class="text-overflow">'+a[this].user_info.name+'</div>            </div>            <img src="'+a[this].thumbnail+'">            <i class="icon icon--lg icon--play-twitch"></i>            <a href="/community?stream='+a[this].login+'" class="b-link"></a>          </div>')}),$(".js-stream").append('<div class="block-nav">        <span class="inline">все<br>стримы</span>        <span class="middle"></span>        <a class="b-link" href="/community"></a>      </div>')}})}function videoLoad(){$("#video")[0].oncanplay=function(){$(this).removeClass("hidden")}}var bannerInterval,bannerTimeout,bannerCurrent;$(document).on("click",".feature__point",function(a){a.preventDefault();var b=$(".feature__point").index($(this));intervalReset(),$(".feature__point").removeClass("active"),$(this).addClass("active"),bannerCurrent.toggleClass("hidden visible"),bannerCurrent=$(".js-feature-item").eq(b),bannerCurrent.toggleClass("hidden visible")}),$(document).on("click",".js-feature-nav",function(a){var b=$(this).data("nav"),c=$(".feature__point.active"),d=$(".feature__point").index(c);"next"==b?3==d?$(".feature__point").eq(0).trigger("click"):c.next().trigger("click"):0==d?$(".feature__point").eq(3).trigger("click"):c.prev().trigger("click")}),streamCreate(),topBanner(),$(document).ready(function(){videoLoad()});